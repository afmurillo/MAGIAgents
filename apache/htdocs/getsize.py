#!/usr/bin/env python

import jon.cgi as cgi
import jon.fcgi as fcgi

databuf = """
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
0123456789012345678901234567890123456789012345678
"""

class Handler(cgi.Handler):
	def process(self, req):
		length = int(req.params.get('length', 0))
		req.set_buffering(req.params.get('buffer', False))
		req.set_header("Content-Type", "text/plain")
		req.set_header("Content-Length", str(length))

		full = length/500
		rem = length%500
		for ii in range(full): 
			req.write(databuf[0:500])
		req.write(databuf[0:rem])

fcgi.Server({fcgi.FCGI_RESPONDER: Handler}).run() 

